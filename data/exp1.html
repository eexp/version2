<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Experiment | Template</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="w3.css">
<link rel="stylesheet" href="css.css">
<link rel="stylesheet" href="font-awesome.css">
<style>
body,h1 {font-family: "Raleway", Arial, sans-serif}
h1 {letter-spacing: 5px}
.w3-row-padding img {margin-bottom: 12px}
</style><style>
  canvas{
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;  }
</style>

<style type="text/css">/* Chart.js */
@keyframes chartjs-render-animation{from{opacity:.99}to{opacity:1}}.chartjs-render-monitor{animation:chartjs-render-animation 1ms}.chartjs-size-monitor,.chartjs-size-monitor-expand,.chartjs-size-monitor-shrink{position:absolute;direction:ltr;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1}.chartjs-size-monitor-expand>div{position:absolute;width:1000000px;height:1000000px;left:0;top:0}.chartjs-size-monitor-shrink>div{position:absolute;width:200%;height:200%;left:0;top:0}</style>

  <!--Add src=.........js that is found in the SPIFFS -->
<script src="CHART.js"> </script> 
<script id="MathJax-script" async src="MJAX.js"></script>
  <style>

  /* Data Table Styling */
  #dataTable {
    font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
    border-collapse: collapse;
    width: 100%;
  }

  #dataTable td, #dataTable th {
    border: 1px solid #ddd;
    padding: 8px;
  }

  #dataTable tr:nth-child(even){background-color: #f2f2f2;}

  #dataTable tr:hover {background-color: #ddd;}

  #dataTable th {
    padding-top: 10px;
    padding-bottom: 10px;
    text-align: left;
    background-color: #4CAF50;
    color: white;
  }

  .responsive_logo {
  width: 100%;
  max-width: 400px;
  height: auto;
}
.responsive_img {
  width: 100%;
  max-width: 800px;
  height: auto;
}
  </style>

<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* fullscreen settings */
:-webkit-full-screen {
  background-color: white;
}
:-moz-full-screen {
  background-color: white;
  width: 100%;
}
:-ms-fullscreen {
  background-color: white;
  width: 100%;
}
:fullscreen {
  background-color: white;
}
</style>


</head>



<body class="vsc-initialized">

<!-- !PAGE CONTENT! -->
<div class="w3-content" style="max-width:93%">

<!-- Header -->
<header class="w3-panel w3-center" style="padding:10px 2px">
  <div class="w3-row-padding" style="margin-bottom:8px">
    <div class="w3-center">
      <img src="logo.png" class="responsive_logo">
    </div>
   </div>

  <h1 class="w3-large">Welcome to a life of experiments</h1>
</header>


<section>
    <div class="container" style="margin-left: 10px">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h2>Measuring gravitational acceleration 1 : Free fall</h2>
          <p class="lead">In 1654, Vincenzo Viviani, a student of Galileo Galilei, wrote the following: Galileo
showed this [all bodies, whatever their weights, fall with equal speeds] by repeated experiments made from the height of the Leaning Tower of Pisa in the presence of other
professors and all the students. This was a milestone in the history of science, since Galileo's realization disproved the longstanding Aristotel's gravitation theory which states
that objects fall with a speed proportional to their mass. Almost two centuries later, in
1842, Julius Mayer wrote down what we now call the Law of Conservation of Energy:
 energy is neither created nor destroyed. The goal of this experiment is to measure and
prove both of the statements. </p>

    <p>
    Consider an object located at height h above the ground. If the height h is much
smaller than the radius of the Earth (\(R_{earth} = 6370km\)), which is certanly true for our
everyday experience, we can safely consider the acceleration on an object caused by the
gravitational pull of the Earth to be constant. This change of the speed caused by the
Earth's gravity is called a gravitational acceleration and is famously denoted by g.
	</p>

	<p>
Being at a height h above the ground, an object has a potential to acquire a speed
after we release it and we say there is a potential energy with respect to the ground. For
the object of mass m, the potential energy at height h relative to the Earth's surface is
given by: \(E_{pot} = mgh\), where g is the gravitational acceleration mentioned above. As the
object falls, its potential energy is decreasing, since h is decreasing. However, the object
accelerates in the process, and acquires the maximum speed when it hits the ground. In
order to describe this phenomena, we introduce the concept of the kinetic energy which
measures the amount of energy in the motion itself. For the object of mass m, moving
with the speed v, the kinetic energy is given by: \(E_k = \frac{mv^2}{2}\) . At any time during
the motion, the object has both the potential and kinetic energy, which are always in a
dynamic interplay of conversion guided by the profound principle of physics called the
Law of Conservation of Energy. If we neglect the friction in our system, meaning that
the energy does not leak to the surrounding in a form of heat or sound, we have a perfect
conversion of the potential to the kinetic energy. This can be neatly written in a form of
an equation:

          \begin{equation}
              E_{pot} = mgh 
              \label{pot}
              \end{equation}
         \begin{equation}
              E_{kin} = \frac{mv^2}{2}
              \label{kin}
          \end{equation}
After we factor out the mass from the equation above, we come to the Galileo's prediction
that the speed of the falling object is independent of its mass.
          \begin{equation}
			v^2=2gh
          \end{equation}
</p>
<p>
 Our goal is to measure gravitational acceleration of the
Earth using the conservation of energy. For that purpose,
we use the system as described in the figure below.
It consist of a fotodetector (FD) able to measure the intensity of light incident on its surface. Along with the
laser positioned on the opposite side, the FD forms a basis
to measure the velocity of the falling object. When the
object passes in front of the FD it blocks the light coming
from the laser, which causes the significant drop in the measured intensity of light. The time of the decreased light
intensity âˆ†t can then be used to calculate the speed of the
object. If the object is the sphere of the diameter d, its
speed is simply found by:

          \begin{equation}
			v=\frac{d}{\Delta t}
          \end{equation}

	</p>

	<p> 

 <ul>
<li>Using the measuring tape provided, vary the initial height of the object with respect
to the FD, and record the speed of the object for diferent values of h.</li>
 <li>Draw the \(v^2\) dependence on h and use equation (2) to extract the value of the
gravitational acceleration.</li>
</ul>
 
	</p>

        </div>
      </div>
    </div>
  </section>

<!-- Photo Example -->
<div class="w3-padding-32" style="margin-bottom:28px">
  <div class="w3-center">
    <img src="exp1fig1.png" class="responsive_img">
  </div>
</div>

<body onload="javascript:init()">



<!------- Buttons and options---------->
<div> 
  <div class="w3-padding-32">
    Select Sampling Interval: 
    <select id="update_interval" onchange="sendDataRate()">
      <option value="1">1s</option>
      <option value="0.01">10 ms</option>
      <option value="0.05">50 ms</option>
      <option value="0.3">300 ms</option>
      <option value="0.5">0.5 s</option>
      <option value="2">2 s</option>
    </select>
    </div>

    <div class="w3-bar w3-border" style="font-size: 13px">
      <button onClick="startRecording()" class="w3-bar-item w3-button w3-light-grey">Start</button>
      <button onClick="stopRecording()" class="w3-bar-item w3-button">Stop</button>
      <button onClick="downloadCSV()" class="w3-bar-item w3-button w3-light-grey">Download</button>
      <button class="w3-bar-item w3-button" onclick="openFullscreen()">Fullscreen</button>
    </div>


</div>
<div id="graph">
    <canvas id="canvas" 
            style="display: block;" 
            width="800" 
            height="450" 
            class="chartjs-render-monitor"> </canvas>
</div>


<!-- Adding a websocket to the client (webpage) -->
<script>
  exp_num = "3"; //number of the experiment
  var webSocket, dataPlot;
  var values = [];
  var timeStamp = [];
  var timeMilis = [];

  window.chartColors = {
  red: 'rgb(255, 99, 132)',
  orange: 'rgb(255, 159, 64)',
  yellow: 'rgb(255, 205, 86)',
  green: 'rgb(75, 192, 192)',
  blue: 'rgb(54, 162, 235)',
  purple: 'rgb(153, 102, 255)',
  grey: 'rgb(201, 203, 207)'
  };

  var config = {
      type: 'line',
      data: {
        labels: timeStamp,
        datasets: [{ label: 'Analog Values',
                     backgroundColor: window.chartColors.red,
                     borderColor: window.chartColors.red,
                     data: values,
                     fill: false,}]},
       
       options: {responsive: true,title: {display: false, text: ''},
        tooltips: {
          mode: 'index',
          intersect: false,
        },
        hover: {
          mode: 'nearest',
          intersect: true
        },
        scales: {
          xAxes: [{
            display: true,
            scaleLabel: {
              display: true,
              labelString: 'Time'
            }
          }],
          yAxes: [{
            display: true,
            scaleLabel: {
              display: true,
              labelString: 'Analog Value'
            }
          }]
        }
      }
    };



  function startRecording(){
  if(recording_active == false){
    recording_active = true;
    interval = document.getElementById("update_interval").value;
    sendDataRate();
    // myTimer = setInterval(getData, interval);
    start_time = new Date().getTime();
  }
  else{
    alert("Recording already in progress!");
  }
}



function stopRecording(){
  if(recording_active ==true){
    recording_active = false;
    sendStopSignal();
  }
  else{
    alert("No active recording!");
  }
}

function downloadCSV(){
  if(recording_active == false){
    let csvContent = "data:text/csv;charset=utf-8,";
    var i;
    csvContent += "time, value\r\n";
    for (i = 0; i < values.length; i++) {
      csvContent += timeMilis[i] +"," + values[i] + "\r\n";
    }  
    var encodedUri = encodeURI(csvContent);
    window.open(encodedUri);
  } else{
    alert("Recording must be stoped!");
  }
}


function wakeUp() {
  var xhttp = new XMLHttpRequest();
  xhttp.open("POST", "activatedexp?exp="+exp_num, true); //pings /activatedexp
  xhttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
  xhttp.onreadystatechange = function() {//Call a function when the state changes.
  if(xhttp.readyState == 4 && http.status == 200) {alert(http.responseText);}}
  xhttp.send(); 
}

function init() {
    webSocket = new WebSocket('ws://' + window.location.hostname + ':81/');
    var ctx = document.getElementById('canvas').getContext('2d');
    window.myLine = new Chart(ctx, config);
    recording_active = false;
    wakeUp()

webSocket.onmessage = function(event) {
  if (recording_active){
  var Value = JSON.parse(event.data).value;
  var time = new Date();
  values.push(Value);
  timeStamp.push(time.toLocaleTimeString());
  timeMilis.push(time.getTime() - start_time);

  //Update Plot
  window.myLine.update();
  //Update Data Table
  // var table = document.getElementById("dataTable");
  // var row = table.insertRow(1); //Add after headings
  // var cell1 = row.insertCell(0);
  // var cell2 = row.insertCell(1);
  // cell1.innerHTML = time.toLocaleTimeString();
  // cell2.innerHTML = ADCValue;
  }
}
};



function sendDataRate(){
  var dataRate = document.getElementById("update_interval").value;
  webSocket.send(dataRate);
  start_time = new Date().getTime();
  }

function sendStopSignal(){
  webSocket.send(0);
  }

 
var elem = document.getElementById("graph");
function openFullscreen() {
  if (elem.requestFullscreen) {
    elem.requestFullscreen();
  } else if (elem.mozRequestFullScreen) { /* Firefox */
    elem.mozRequestFullScreen();
  } else if (elem.webkitRequestFullscreen) { 
    elem.webkitRequestFullscreen();
  } else if (elem.msRequestFullscreen) { /* IE/Edge */
    elem.msRequestFullscreen();
  }
}
</script>

</body>

<footer class="w3-container w3-padding-64 w3-light-grey w3-center w3-large"> 
  <p>Project by <a href="expertexperiments.pythonanywhere.com/" target="_blank" class="w3-hover-text-green">ExpertExperiments</a></p>
</footer>
</html>


</body></html>